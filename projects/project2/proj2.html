<!DOCTYPE html>
<html lang="en">
<head>
	<title> Portfolio Projects - Project 2 </title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" type="text/css" href="../../style.css" />
</head>
<body>
	<header id="branding">
		<h1>Personal and industrial products by Kyle Watson</h1>
		<nav id="navigation">
			<h2> Navigation </h2>
			<ul>
				<li class="nav"><a href="../../index.html"> Home </a></li>
				<li class="nav"><a href="../../personal.html"> Personal Bio </a></li>
				<li class="title-nested"> <a> Projects </a>
					<ol>
						<li class="nested-item"><a href="../project1/proj1.html"> <abbr title="Universal Serial Bus">USB</abbr> Backup </a></li>
						<li class="nested-item"><a href="proj2.html"> <abbr title="Grand Theft Auto">GTA</abbr> Graphics Fix </a></li>
						<li class="nested-item"> More Coming Soon! </li>
					</ol>
				</li>
				<li class="nav"><a href="../../contact.html"> Contact me </a></li>
			</ul>
		</nav>
	</header>
	<main>
		<!-- Content starts here -->
		<aside>
			<h2> <abbr title="Grand Theft Auto">GTA</abbr> Graphics Fix (C#) </h2>
			<p>
				This page showcases a windows service I developed to solve an annoying problem and learn the simplicity of C#.
			</p>
			<ul>
				<li><a href="#source">Source Code</a></li>
				<li><a href="#use">Usage</a></li>
				<li><a href="#downloads">Downloads</a></li>
				<li><a href="#description">Description</a></li>
			</ul>
		</aside>
		<section id="source">
			<h3> Source Code </h3>
			<!--<details> tag not supported in many browsers yet so this should do -->
			<p class="details">
				This code only works on my PC and <em>may behave differently</em> if compiled and installed on a different
				machine. The service when running along side the game <strong>will definitely slow down all other
				programs</strong> running on the machine.
			</p>
			<h4>Service File (Service1.cs)</h4>
			<pre>
				<code>
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Diagnostics;
using System.Linq;
using System.ServiceProcess;
using System.Text;
using System.Threading.Tasks;

namespace WindowsService1
{
    public partial class GrandTheftAutoPriority : ServiceBase
    {
        public GrandTheftAutoPriority()
        {
            InitializeComponent();
        }

        void StartTimer()
        {
            System.Timers.Timer checkInterval = new System.Timers.Timer();
            checkInterval.Interval = 10000;
            checkInterval.AutoReset = true;
            checkInterval.Elapsed += CheckProcesses;
            checkInterval.Enabled = true;
        }

        void CheckProcesses(Object source, System.Timers.ElapsedEventArgs e)
        {
            Process[] processList = Process.GetProcesses();
            foreach(Process processA in processList)
            {
                if(processA.ProcessName == &quot;GTA5&quot; || processA.ProcessName == &quot;ScpService&quot;)
                {
                    processA.PriorityClass = ProcessPriorityClass.AboveNormal;
                }
            }
        }

        protected override void OnStart(string[] args)
        {
            StartTimer();
        }

        protected override void OnStop()
        {
        }
    }
}

				</code>
			</pre>
			<h4>Service Design File (ProjectInstaller.Designer.cs)</h4>
			<pre>
				<code>
namespace WindowsService1
{
    partial class ProjectInstaller
    {
      ///Code Generated by Visual Studio to describe the service.
        /// &lt;summary&gt;
        /// Required designer variable.
        /// &lt;/summary&gt;
        private System.ComponentModel.IContainer components = null;

        /// &lt;summary&gt;
        /// Clean up any resources being used.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;disposing&quot;&gt;true if managed resources should be disposed; otherwise, false.&lt;/param&gt;
        protected override void Dispose(bool disposing)
        {
            if (disposing &amp;&amp; (components != null))
            {
                components.Dispose();
            }
            base.Dispose(disposing);
        }

        #region Component Designer generated code

        /// &lt;summary&gt;
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// &lt;/summary&gt;
        private void InitializeComponent()
        {
            this.serviceProcessInstaller1 = new System.ServiceProcess.ServiceProcessInstaller();
            this.serviceInstaller1 = new System.ServiceProcess.ServiceInstaller();
            //
            // serviceProcessInstaller1
            //
            this.serviceProcessInstaller1.Account = System.ServiceProcess.ServiceAccount.LocalSystem;
            this.serviceProcessInstaller1.Password = null;
            this.serviceProcessInstaller1.Username = null;
            //
            // serviceInstaller1
            //
            this.serviceInstaller1.Description = &quot;Check to see if GTAV and SCP driver have launched every 10s and set there priorit&quot; +
    &quot;y to high.&quot;;
            this.serviceInstaller1.DisplayName = &quot;GTAV Priority Changer&quot;;
            this.serviceInstaller1.ServiceName = &quot;GrandTheftAutoPriority&quot;;
            this.serviceInstaller1.StartType = System.ServiceProcess.ServiceStartMode.Automatic;
            //
            // ProjectInstaller
            //
            this.Installers.AddRange(new System.Configuration.Install.Installer[] {
            this.serviceProcessInstaller1,
            this.serviceInstaller1});

        }

        #endregion

        private System.ServiceProcess.ServiceProcessInstaller serviceProcessInstaller1;
        private System.ServiceProcess.ServiceInstaller serviceInstaller1;
    }
}
				</code>
			</pre>
		</section>
		<section id="use">
			<h3> Usage </h3>
			<p>
				As this was only developed for my use I don't have any proper usage or installation instructions. Although I
				followed the Microsoft Developers tutorial on how to compile and install a service made with Visual Studio and
				C#.
			</p>
		</section>
		<section id="downloads">
			<h3>Downloads</h3>
			<ul>
				<li><a href="downloads/Service1.cs" target="_blank">Service File (Service1.cs)</a></li>
				<li><a href="downloads/ProjectInstaller.Designer.cs" target="_blank">Service Design (ProjectInstaller.Designer.cs)</a></li>
				<li><a href="downloads/project.zip" target="_blank">Visual Studio Project (project.zip)</a></li>
				<li><a href="images/gta2.jpg" target="_blank">Game Screenshot (gta2.jpg)</a></li>
			</ul>
		</section>
		<section id="description">
			<h3> Description </h3>
			<p>
				This program is written as an installable Microsoft Windows service. Once installed it will check the
				system every 10 seconds to see if either the <abbr title="Grand Theft Auto 5">GTA V</abbr>
				<abbr title="Executable">exe</abbr> has been launched or if the
				<abbr title="Scarlet Crush Productions">SCP</abbr> <abbr title="Play Station 3">PS3</abbr> controller driver
				has been launched. If either of these have it will set the process priority to high.
				This solved a graphics issue where textures were not loading into the game quick enough <a href="https://www.reddit.com/r/pcmasterrace/comments/32ib6y/anyone_else_getting_these_texture_bugs_gta_v/" target="_blank">(pop-in example [reddit.com thread by:Jakey120])</a>, although just changing
				the priority of the game executable slowed down the controller driver causing bad latency. This is why the
				driver priority also needed to be changed.
			</p>
			<figure>
				<img src="images/gta2.jpg" height="450" width="800" alt="Screenshot of the GTA V game"/>
				<figcaption>
					This is what the should look like after the fix is applied. All the textures have loaded in properly and
					the performance is acceptable.
				</figcaption>
			</figure>
		</section>
		<!-- Content ends here -->
	</main>
	<footer id="contact">
		<address>
			Created by some <a href="mailto:k.j.watson1@edu.salford.ac.uk">guy</a>.
		</address>
		<p>Last Modified: 07/11/16 14:28</p>
		<nav id="bottom-nav">
			<p>
				<ul>
					<li><a href="#">Back to the top.</a></li>
					<li id="back-button"><a href="../project1/proj1.html">Previous project.</a></li>
				</ul>
			</p>
		</nav>
	</footer>
</body>
</html>
